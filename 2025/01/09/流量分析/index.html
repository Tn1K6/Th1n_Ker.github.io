

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Th1n_Ker">
  <meta name="keywords" content="">
  
    <meta name="description" content="前言2025年第一章！2024年打完数证杯线下赛后，就有点摆，所以就没怎么写文章。之前就一直说学流量分析再加上之后的比赛要用，就把这篇文章写出来啦！希望没有什么遗漏。如有错误或不足的地方，请各位大佬指出，多多指点！ 初步认识菜单栏 工具栏 区块   调整Wireshark列表详情里的默认的时间显示格式不太友好，需要做一下调整。  在Wireshark中菜单栏的统计，和工具栏的查找分组（Ctrl +">
<meta property="og:type" content="article">
<meta property="og:title" content="流量分析">
<meta property="og:url" content="http://example.com/2025/01/09/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="前言2025年第一章！2024年打完数证杯线下赛后，就有点摆，所以就没怎么写文章。之前就一直说学流量分析再加上之后的比赛要用，就把这篇文章写出来啦！希望没有什么遗漏。如有错误或不足的地方，请各位大佬指出，多多指点！ 初步认识菜单栏 工具栏 区块   调整Wireshark列表详情里的默认的时间显示格式不太友好，需要做一下调整。  在Wireshark中菜单栏的统计，和工具栏的查找分组（Ctrl +">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/stm.jpg">
<meta property="article:published_time" content="2025-01-09T07:37:56.000Z">
<meta property="article:modified_time" content="2025-01-09T08:10:05.647Z">
<meta property="article:author" content="Th1n_Ker">
<meta property="article:tag" content="应急响应">
<meta property="article:tag" content="流量分析">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/stm.jpg">
  
  
  
  <title>流量分析 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"BsziA1UcBtxARPC3IXbFc4Jm-gzGzoHsz","app_key":"EwKiJeIitpXRphq057k7iiU1","server_url":"https://bszia1uc.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Th1n_Ker</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/ZX1.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="流量分析"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-01-09 15:37" pubdate>
          2025年1月9日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          60 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">流量分析</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>2025年第一章！2024年打完数证杯线下赛后，就有点摆，所以就没怎么写文章。之前就一直说学流量分析再加上之后的比赛要用，就把这篇文章写出来啦！希望没有什么遗漏。如有错误或不足的地方，请各位大佬指出，多多指点！</p>
<h4 id="初步认识"><a href="#初步认识" class="headerlink" title="初步认识"></a>初步认识</h4><h5 id="菜单栏"><a href="#菜单栏" class="headerlink" title="菜单栏"></a>菜单栏</h5><p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/1.png" srcset="/img/loading.gif" lazyload></font></p>
<h5 id="工具栏"><a href="#工具栏" class="headerlink" title="工具栏"></a>工具栏</h5><p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/2.png" srcset="/img/loading.gif" lazyload></font></p>
<h5 id="区块"><a href="#区块" class="headerlink" title="区块"></a>区块</h5><p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/3.png" srcset="/img/loading.gif" lazyload></font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/4.jpeg" srcset="/img/loading.gif" lazyload></font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/5.png" srcset="/img/loading.gif" lazyload></font></p>
<h5 id="调整"><a href="#调整" class="headerlink" title="调整"></a>调整</h5><p>Wireshark列表详情里的默认的时间显示格式不太友好，需要做一下调整。</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/6.png" srcset="/img/loading.gif" lazyload></font></p>
<p>在Wireshark中<font style="background-color:#FBDE28;">菜单栏的统计</font>，和<font style="background-color:#FBDE28;">工具栏的查找分组</font>（<font style="color:rgba(0, 0, 255, 1);">Ctrl + F   打开</font>）都是很好用的功能！</p>
<h4 id="过滤语法使用"><a href="#过滤语法使用" class="headerlink" title="过滤语法使用"></a>过滤语法使用</h4><h5 id="显示过滤器"><a href="#显示过滤器" class="headerlink" title="显示过滤器"></a>显示过滤器</h5><p>我们在这里输入过滤语法</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/7.png" srcset="/img/loading.gif" lazyload></font></p>
<h4 id="过滤语法："><a href="#过滤语法：" class="headerlink" title="过滤语法："></a>过滤语法：</h4><p> 抓包过滤器类型：Type（host、net、port）、</p>
<pre><code class="hljs">                        方向Dir（src、dst）、

                        协议Proto（ether、ip、tcp、udp、http、icmp、ftp等）、

                        逻辑运算符（&amp;&amp; 与、|| 或、！非）  
</code></pre>
<p>过滤协议:     tcp(过滤TCP)            udp(过滤UDP)          http(过滤HTTP)      ftp(过滤FTP)  </p>
<p>过滤IP:        ip.src &#x3D;&#x3D;地址(源)    ip.dst &#x3D;&#x3D;地址(目)       ip.addr &#x3D;&#x3D;地址(双向) </p>
<p>过滤端口: tcp.srcport &#x3D;&#x3D; 端口(源)    tcp.dstport &#x3D;&#x3D;端口(目)     tcp.port &#x3D;&#x3D;端口(双向)</p>
<p>过滤MAC: eth.src&#x3D;&#x3D;网卡地址(源)     eth.dst &#x3D;&#x3D;网卡地址(目)     eth.addr &#x3D;&#x3D;网卡地址(双向)</p>
<p>过滤包长:ip.len &#x3D;&#x3D;值     tcp.len &#x3D;&#x3D;值      frame.en &#x3D;&#x3D;值        udp.length &#x3D;&#x3D;值</p>
<p>过滤HTTP请求:    http.request.method&#x3D;&#x3D;“GET”  </p>
<pre><code class="hljs">                       http.request.method== “POST&quot;

                       http.request.uri==“/img/test.gif”

                       `http.response.code == 200`

                          http.request.uri contains &quot;login&quot;  

                         frame.len == 978      #包长
</code></pre>
<p><font style="color:#DF2A3F;background-color:#FFFFFF;">配合分组查找使用更佳！！！</font></p>
<p><font style="color:#000000;background-color:#FFFFFF;">当我们用过滤语法把大致范围划出来，就可以使用</font><font style="color:#000000;background-color:#C1E77E;">分组查找</font><font style="color:#000000;background-color:#FFFFFF;">在  分组列表  、分组详情  、 分组字节流  中</font><font style="color:#000000;background-color:#C1E77E;">查找关键字</font></p>
<p><font style="color:#000000;background-color:#FFFFFF;">当我们不知道过滤字段，可以在分组详情中找到想要过滤的字段通过右键单击&#x3D;&#x3D;&#x3D;》作为过滤器应用&#x3D;&#x3D;&#x3D;》选中</font></p>
<p><font style="color:#000000;background-color:#FFFFFF;">该方法也可以在接下来的</font><font style="color:rgba(0, 0, 0, 0.87);">Tshark中运用到</font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/8.png" srcset="/img/loading.gif" lazyload></font></p>
<h4 id="常用功能使用"><a href="#常用功能使用" class="headerlink" title="常用功能使用"></a>常用功能使用</h4><h5 id="导出数据包"><a href="#导出数据包" class="headerlink" title="导出数据包"></a>导出数据包</h5><p>菜单栏&#x3D;&#x3D;》文件 &#x3D;&#x3D;&#x3D;》导出特定的分组字节流</p>
<p>如果流量包过大会<font style="background-color:#FBDE28;">导致加载过慢</font>，<font style="background-color:#FBDE28;">无用数据过多</font>之类的情况，这时候就可以使用到它（如果找到了攻击者开始攻击和结束的时间，就可以直接导出来重点分析）</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/9.png" srcset="/img/loading.gif" lazyload></font></p>
<h5 id="导出对象"><a href="#导出对象" class="headerlink" title="导出对象"></a>导出对象</h5><p>菜单&#x3D;&#x3D;》文件 &#x3D;&#x3D;&#x3D;》导出对象</p>
<details class="lake-collapse"><summary id="u5c8513b1"><span class="ne-text">Wireshark的导出对象功能主要有以下六个，分别介绍如下(点击打开折叠块)：</span></summary><h6 id="pq13F"><span class="ne-text">导出DICOM对象</span></h6><ul class="ne-ul"><li id="u0013ba01" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：DICOM即Digital Imaging and Communications in Medicine，是医学数字图像与通信的简称，该功能可将捕获到的通过DICOM协议传输的医学影像及相关数据保存为本地文件。</span></li><li id="u7dbb29c5" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：主要用于医疗领域，当需要对网络中传输的医疗影像数据进行分析、存档或进一步处理时，可使用此功能导出DICOM对象。</span></li></ul><h6 id="R2aH2"><span class="ne-text">导出HTTP对象</span></h6><ul class="ne-ul"><li id="u6b79b8ee" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：将捕获的通过HTTP协议传输的文件对象导出到本地，如网页中的图片、脚本、样式表、HTML文档等。</span></li><li id="u7867949c" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：在分析网站性能、排查网页加载问题或研究HTTP数据传输情况时非常有用。例如，当网站的某些资源加载异常时，可以通过导出HTTP对象来获取具体的文件内容，查看是否存在文件损坏或错误配置等问题。</span></li></ul><h6 id="MugJa"><span class="ne-text">导出IMF对象</span></h6><ul class="ne-ul"><li id="u7885be66" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：IMF即Internet Message Format，此功能可将捕获到的符合互联网消息格式的邮件对象导出。</span></li><li id="u87dd914e" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：在网络安全监控或邮件系统故障排查中，若怀疑邮件传输存在问题，如邮件内容被篡改、邮件附件丢失等，可以使用该功能导出IMF对象进行详细分析。</span></li></ul><h6 id="ngSVg"><span class="ne-text">导出SMB对象</span></h6><ul class="ne-ul"><li id="uc6f6c1ac" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：SMB即Server Message Block，用于Web连接和客户端与服务端之间的信息沟通，该功能可将通过SMB协议传输的文件导出。</span></li><li id="uf03f7daf" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：在企业网络环境中，常用于分析文件共享和打印服务等操作。比如，当用户无法正常访问共享文件夹或打印文件时，可以通过导出SMB对象来查看传输过程中的数据包和文件内容，排查问题所在。</span></li></ul><h6 id="PVtzo"><span class="ne-text">导出TFT对象</span></h6><ul class="ne-ul"><li id="u34b91e18" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：TFT是Text Formatter Plus File，是Windows在DOS下的一种文件格式，可将捕获到的TFT格式的文件导出。</span></li><li id="u176dc1e1" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：在涉及到Windows DOS应用程序或特定的文本数据处理场景中，若需要对TFT格式的文件进行单独分析或处理，可使用此功能。</span></li></ul><h6 id="BD3VC"><span class="ne-text">导出FTP对象</span></h6><ul class="ne-ul"><li id="u1a94443c" data-lake-index-type="0"><strong><span class="ne-text">功能概述</span></strong><span class="ne-text">：将捕获到的通过FTP协议传输的文件导出到本地。</span></li><li id="u9d233101" data-lake-index-type="0"><strong><span class="ne-text">适用场景</span></strong><span class="ne-text">：在对FTP服务器进行安全审计或排查FTP文件传输故障时，可通过导出FTP对象来查看传输的文件内容、权限设置等信息，以发现潜在的安全漏洞或传输问题。</span></li></ul></details>

<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/10.png" srcset="/img/loading.gif" lazyload></font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">W</font><font style="color:rgba(0, 0, 0, 0.87);">indows</font><font style="color:rgba(0, 0, 0, 0.87);"> </font><font style="color:rgba(0, 0, 0, 0.87);">NT与windows操作系统对应关系如下：</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 5.1: Windows XP</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 6.0: Windows Vista</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 6.1: Windows 7</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 6.2: Windows 8</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 6.3: Windows 8.1</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">Windows NT 10.0: Windows 10</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);"></font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);"></font></p>
<h4 id="Tshark"><a href="#Tshark" class="headerlink" title="Tshark"></a><font style="color:rgba(0, 0, 0, 0.87);">Tshark</font></h4><p>介绍：</p>
<p> tshark相当于是命令行版的wireshark，不需要额外安装，在安装wireshark的时候就会安装上这个工具。 参考： <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44288604/article/details/123807294?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522198ae8dab0578ec4c496febf7cfb49e2%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=198ae8dab0578ec4c496febf7cfb49e2&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-16-123807294-null-null.142%5Ev101%5Epc_search_result_base6&utm_term=tshark%E6%80%8E%E4%B9%88%E7%94%A8&spm=1018.2226.3001.4187">tshark在流量分析中的绝佳应用（超详细）-CSDN博客</a></p>
<h5 id="参数介绍："><a href="#参数介绍：" class="headerlink" title="参数介绍："></a><font style="color:rgba(0, 0, 0, 0.87);">参数介绍：</font></h5><details class="lake-collapse"><summary id="ucce09d40"><span class="ne-text">参数介绍</span></summary><ol class="ne-ol"><li id="ubc8dd10b" data-lake-index-type="0"><span class="ne-text">抓包接口类<br /></span><span class="ne-text">-i 设置抓包的网络接口，不设置则默认为第一个非自环接口。<br /></span><span class="ne-text">-D 列出当前存在的网络接口。在不了解OS所控制的网络设备时，一般先用“tshark -D”查看网络接口的编号以供-i参数使用。<br /></span><span class="ne-text">-f 设定抓包过滤表达式（capture filter expression）。抓包过滤表达式的写法雷同于tcpdump，可参考tcpdump man page的有关部分。<br /></span><span class="ne-text">-s 设置每个抓包的大小，默认为65535，多于这个大小的数据将不会被程序记入内存、写入文件。（这个参数相当于tcpdump的-s，tcpdump默认抓包的大小仅为68）<br /></span><span class="ne-text">-p 设置网络接口以非混合模式工作，即只关心和本机有关的流量。<br /></span><span class="ne-text">-B 设置内核缓冲区大小，仅对windows有效。<br /></span><span class="ne-text">-y 设置抓包的数据链路层协议，不设置则默认为-L找到的第一个协议，局域网一般是EN10MB等。<br /></span><span class="ne-text">-L 列出本机支持的数据链路层协议，供-y参数使用。 </span></li><li id="u140d0385" data-lake-index-type="0"><span class="ne-text">抓包停止条件<br /></span><span class="ne-text">-c 抓取的packet数，在处理一定数量的packet后，停止抓取，程序退出。<br /></span><span class="ne-text">-a 设置tshark抓包停止向文件书写的条件，事实上是tshark在正常启动之后停止工作并返回的条件。条件写为test:value的形式，如“-a duration:5”表示tshark启动后在5秒内抓包然后停止；“-a filesize:10”表示tshark在输出文件达到10kB后停止；“-a files:n”表示tshark在写满n个文件后停止。（windows版的tshark0.99.3用参数“-a files:n”不起作用——会有无数多个文件生成。由于-b参数有自己的files参数，所谓“和-b的其它参数结合使用”无从说起。这也许是一个bug，或tshark的man page的书写有误。）</span></li><li id="uace03b54" data-lake-index-type="0"><span class="ne-text">文件输出控制<br /></span><span class="ne-text">-b 设置ring buffer文件参数。ring buffer的文件名由-w参数决定。-b参数采用test:value的形式书写。“-b duration:5”表示每5秒写下一个ring buffer文件；“-b filesize:5”表示每达到5kB写下一个ring buffer文件；“-b files:7”表示ring buffer文件最多7个，周而复始地使用，如果这个参数不设定，tshark会将磁盘写满为止。</span></li><li id="u164912e5" data-lake-index-type="0"><span class="ne-text">文件输入<br /></span><span class="ne-text">-r 设置tshark分析的输入文件。tshark既可以抓取分析即时的网络流量，又可以分析dump在文件中的数据。-r不能是命名管道和标准输入。</span></li><li id="u25a5dcdc" data-lake-index-type="0"><span class="ne-text">处理类<br /></span><span class="ne-text">-R 设置读取（显示）过滤表达式（read filter expression）。不符合此表达式的流量同样不会被写入文件。注意，读取（显示）过滤表达式的语法和底层相关的抓包过滤表达式语法不相同，它的语法表达要丰富得多，请参考</span><span class="ne-text">http://www.ethereal.com/docs/dfref/和http://www.ethereal.com/docs/man-pages/ethereal-filter.4.html。类似于抓包过滤表达式，在命令行使用时最好将它们quote起来。</span><span class="ne-text"><br /></span><span class="ne-text">-n 禁止所有地址名字解析（默认为允许所有）。<br /></span><span class="ne-text">-N 启用某一层的地址名字解析。“m”代表MAC层，“n”代表网络层，“t”代表传输层，“C”代表当前异步DNS查找。如果-n和-N参数同时存在，-n将被忽略。如果-n和-N参数都不写，则默认打开所有地址名字解析。<br /></span><span class="ne-text">-d 将指定的数据按有关协议解包输出。如要将tcp 8888端口的流量按http解包，应该写为“-d tcp.port==8888,http”。注意选择子和解包协议之间不能留空格。</span></li><li id="u94100ca0" data-lake-index-type="0"><span class="ne-text">输出类<br /></span><span class="ne-text">-w 设置raw数据的输出文件。这个参数不设置，tshark将会把解码结果输出到stdout。“-w-”表示把raw输出到stdout。如果要把解码结果输出到文件，使用重定向“&gt;”而不要-w参数。<br /></span><span class="ne-text">-F 设置输出raw数据的格式，默认为libpcap。“tshark -F”会列出所有支持的raw格式。<br /></span><span class="ne-text">-V 设置将解码结果的细节输出，否则解码结果仅显示一个packet一行的summary。<br /></span><span class="ne-text">-x 设置在解码输出结果中，每个packet后面以HEX dump的方式显示具体数据。<br /></span><span class="ne-text">-T 设置解码结果输出的格式，包括text,ps,psml和pdml，默认为text。<br /></span><span class="ne-text">-t 设置解码结果的时间格式。“ad”表示带日期的绝对时间，“a”表示不带日期的绝对时间，“r”表示从第一个包到现在的相对时间，“d”表示两个相邻包之间的增量时间（delta）。<br /></span><span class="ne-text">-S 在向raw文件输出的同时，将解码结果打印到控制台。<br /></span><span class="ne-text">-l 在处理每个包时即时刷新输出。<br /></span><span class="ne-text">-X 扩展项。<br /></span><span class="ne-text">-q 设置安静的stdout输出（例如做统计时）<br /></span><span class="ne-text">-z 设置统计参数。</span></li><li id="udc43b940" data-lake-index-type="0"><span class="ne-text">其它<br /></span><span class="ne-text">-h 显示命令行帮助。<br /></span><span class="ne-text">-v 显示tshark的版本信息。<br /></span><span class="ne-text">-o 重载选项。</span></li></ol></details>

<h6 id="Y–显示过滤器"><a href="#Y–显示过滤器" class="headerlink" title="-Y–显示过滤器"></a>-Y–显示过滤器</h6><p>在这里可以使用过滤语法</p>
<h6 id="e参数的应用"><a href="#e参数的应用" class="headerlink" title="-e参数的应用"></a><font style="color:rgba(0, 0, 0, 0.87);">-e参数的应用</font></h6><p><font style="color:rgba(0, 0, 0, 0.87);">使用</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.87);&quot;&gt;-T&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.87);">参数可以把读取到的数据包以 ek|fields|json|jsonraw|pdml|ps|psml|tabs|text 格式输出，如果希望对输出结果进行更细腻的过滤，就可以使用</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.87);&quot;&gt;-e&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.87);">参数。</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);"></font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">可以指定的字段，把字段的内容全部导出</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">举例：</font><font style="color:#000000;background-color:#FBDE28;">tshark -r timu.pcapng -T fields -Y “http” -e http.request.uri.query &gt;3.txt</font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/11.png" srcset="/img/loading.gif" lazyload></font></p>
<p>结果：</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/12.png" srcset="/img/loading.gif" lazyload></font></p>
<hr>
<p>可以把http流量包中的请求内容和响应内容提取出来</p>
<p>tshark -r ez.pcapng -T fields -Y “http” -e tcp.payload &gt;1.txt       &#x3D;&#x3D;&#x3D;》提取全部内容</p>
<p>tshark -r ez.pcapng -T fields -Y “http.response.code &#x3D;&#x3D; 200” -e tcp.payload &gt;1.txt      &#x3D;&#x3D;&#x3D;》只提取响应内容</p>
<p>提取出来的数据（需要把十六位数据转换为UTF-8）：</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/13.png" srcset="/img/loading.gif" lazyload></font></p>
<p>脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plain">import binascii<br>import os<br><br>file_path_1 = &quot;1.txt&quot;<br>file_path_2 = &quot;2.txt&quot;<br>try:<br>    with open(file_path_1, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br>        valid_chars = set(&quot;0123456789abcdefABCDEF&quot;)<br>        new_hex_data = &quot;&quot;<br>        for char in hex_data:<br>            if char in valid_chars:<br>                new_hex_data += char<br>        hex_data = new_hex_data<br>        if len(hex_data) % 2 == 1:<br>            hex_data += &quot;0&quot;<br><br>        try:<br>            text_data = binascii.unhexlify(hex_data).decode(&#x27;utf-8&#x27;, &#x27;replace&#x27;)<br>            with open(file_path_2, &#x27;w&#x27;, encoding=&#x27;UTF-8&#x27;) as output_file:<br>                output_file.write(text_data)<br>            print(f&quot;转换后的文本内容已成功存入 &#123;file_path_2&#125; 文件。&quot;)<br>        except UnicodeDecodeError:<br>            print(&quot;转换为文本时出现解码错误，可能数据不是标准的UTF-8编码格式&quot;)<br>        except binascii.Error:<br>            print(&quot;十六进制数据转换字节数据时出现其他错误&quot;)<br>except FileNotFoundError:<br>    print(f&quot;文件 &#123;file_path_1&#125; 不存在，请检查文件是否存在及路径是否正确。&quot;)<br>except IOError:<br>    print(f&quot;读取文件 &#123;file_path_1&#125; 时出现I/O错误，请检查文件是否可正常读取。&quot;)<br><br></code></pre></td></tr></table></figure>

<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/14.png" srcset="/img/loading.gif" lazyload></font></p>
<p><strong>总结：先使用-Y参数过滤出需要的流量包，再使用-e参数从流量包中提取指定的内容</strong></p>
<h4 id="技巧："><a href="#技巧：" class="headerlink" title="技巧："></a><font style="color:rgba(0, 0, 0, 0.87);">技巧：</font></h4><p><font style="color:rgba(0, 0, 0, 0.87);">1、直接在分组查找中</font><font style="color:rgba(0, 0, 0, 0.87);background-color:#FBDE28;">根据情况搜索关键字</font><font style="color:rgba(0, 0, 0, 0.87);">，如”ctf”,”pass”,”base64后的flag&#x3D;&#x3D;》ZmxhZw&#x3D;&#x3D;（取一半去搜索）”等。</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);">2、根据流量的协议，去</font><font style="color:rgba(0, 0, 0, 0.87);background-color:#FBDE28;">查看导出对象功能</font><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;">，如http协议较多就看</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;&quot;&gt;HTTP对象列表&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;">里有哪些内容。（里面可能会有压缩包啊，内存文件，隐写后的图片等）</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;">3、也可以对流量包使用 foremost  做分离。</font></p>
<p><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;">4、遇到需要从流量中提取坐标的，可以使用strings命令，如：</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;&quot;&gt;strings -a cap.pcapng |grep &quot;\[.*\]&quot;&lt;/font&gt;</code></p>
<p><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;"></font></p>
<p><strong><font style="color:rgba(0, 0, 0, 0.87);background-color:#FFFFFF;">对于带关联性的流量分析我就不在这里写了，这种流量题目我们要先了解一些渗透测试的手段，这样能让我们快速知道攻击者的大概思路，攻击手段和步骤。帮助我们快速分析做题。在做题的过程中也要做好思维导图，用于梳理逻辑。</font></strong></p>
<h4 id="题目案例"><a href="#题目案例" class="headerlink" title="题目案例"></a>题目案例</h4><p>题目检材：<a target="_blank" rel="noopener" href="https://pan.quark.cn/s/d7de90b67d44">https://pan.quark.cn/s/d7de90b67d44</a></p>
<h5 id="1、-鹤城杯-2021-流量分析"><a href="#1、-鹤城杯-2021-流量分析" class="headerlink" title="1、[鹤城杯 2021]流量分析"></a>1、[鹤城杯 2021]流量分析</h5><p>进入后很容易看出实在布尔盲注</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/15.png" srcset="/img/loading.gif" lazyload></font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">import re<br>s = r&quot;from%20t\),([0-9]*),1\)\)=([0-9]*)&quot;<br>pat = re.compile(s)<br>f = open(&quot;timu.pcapng&quot;,&quot;rb&quot;)<br>st = f.read().decode(&quot;utf-8&quot;,&quot;ignore&quot;)<br>lis = pat.findall(st)<br>flag = [&#x27;&#x27; for i in range(1000)]<br>for t in lis:<br>    flag[int(t[0])] = chr(int(t[1]))<br><br><br>for i in flag:<br>    print(i,end=&quot;&quot;)<br><br></code></pre></td></tr></table></figure>

<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/16.png" srcset="/img/loading.gif" lazyload></font></p>
<h5 id="2、-CISCN2023-被加密的生产流量"><a href="#2、-CISCN2023-被加密的生产流量" class="headerlink" title="2、[CISCN2023]被加密的生产流量"></a>2、[CISCN2023]被加密的生产流量</h5><blockquote>
<p> 某安全部门发现某涉密工厂生产人员偷偷通过生产网络传输数据给不明人员，通过技术手段截获出一段通讯流量，但是其中的关键信息被进行了加密，请你根据流量包的内容，找出被加密的信息。（得到的字符串需要以flag{xxx}形式提交）  </p>
</blockquote>
<p> modbus流量大致有两个点，一个是<code>Register</code>的值，一个是<code>Word Count</code></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/17.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 提取<code>modbus.word_cnt</code>的值  </p>
<p>命令：</p>
<p><code>tshark.exe -r .\modbus.pcap -Y &#39;modbus.word_cnt&#39; -e modbus.word_cnt -T fields &gt; modbus.txt</code></p>
<details class="lake-collapse"><summary id="u4b653c2c"><span class="ne-text">作用</span></summary><p id="uadd21269" class="ne-p"><span class="ne-text">这条命令的作用是使用tshark.exe工具从当前目录下的modbus.pcap文件中读取数据包，通过过滤器筛选出包含'modbus.word_cnt'字段的数据包，提取出该字段的值，并以纯文本形式输出到当前目录下的modbus.txt文件中，具体解释如下：</span></p><ul class="ne-ul"><li id="u8450a28b" data-lake-index-type="0"><strong><span class="ne-text">tshark.exe</span></strong><span class="ne-text">：是Wireshark网络分析工具的命令行版本，用于捕获和分析网络数据包。</span></li><li id="ub36ca1a8" data-lake-index-type="0"><strong><span class="ne-text">-r.\modbus.pcap</span></strong><span class="ne-text">：指定要读取的输入文件为当前目录下的modbus.pcap。pcap是一种常用的网络数据包捕获文件格式，包含了网络通信的原始数据。</span></li><li id="u108dd126" data-lake-index-type="0"><strong><span class="ne-text">-Y'modbus.word_cnt'</span></strong><span class="ne-text">：这是一个显示过滤器，用于筛选出满足'modbus.word_cnt'条件的数据包。只有符合该条件的数据包才会被后续的操作处理。</span></li><li id="u99d3191d" data-lake-index-type="0"><strong><span class="ne-text">-e modbus.word_cnt</span></strong><span class="ne-text">：指定要提取的字段为'modbus.word_cnt'。tshark会从满足过滤条件的数据包中提取出该字段的值。</span></li><li id="u1bafe18e" data-lake-index-type="0"><strong><span class="ne-text">-T fields</span></strong><span class="ne-text">：指定输出格式为只显示提取的字段内容，而不包含其他额外的信息，如数据包的时间戳、源地址、目的地址等。</span></li><li id="u19c5488a" data-lake-index-type="0"><strong><span class="ne-text">&gt; modbus.txt</span></strong><span class="ne-text">：将前面提取并格式化后的内容重定向输出到当前目录下的modbus.txt文件中。如果该文件不存在，则会创建一个新文件；如果文件已存在，则会覆盖原有内容。</span></li></ul></details>
 是10进制转字符串,然后是base32解码

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">import libnum<br>import base64<br> <br>a = &quot;&quot;&quot;19789<br>22871<br>19800<br>13127<br>20037<br>22871<br>20312<br>23122<br>18241<br>22852<br>16701<br>15677&quot;&quot;&quot;<br>b = a.split(&quot;\n&quot;)<br>print(b)<br>c = &quot;&quot;<br>for i in b:<br>    c += libnum.n2s(int(i)).decode(&#x27;utf-8&#x27;)<br> <br>print(base64.b32decode(c))<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">#modbus_exp<br>import pyshark<br> <br>flag = &#x27;&#x27;<br>tmp = 0<br>cap = pyshark.FileCapture(input_file=&quot;D:/下载/CTF附件/ciscn2023/modbus.pcap&quot;,tshark_path=&#x27;D:/Wireshark/&#x27;,display_filter=&#x27;modbus  &amp;&amp; frame.len == 66&#x27;)<br> <br> <br>def hex2str(id:str) -&gt; str:<br>    return str(bytes.fromhex(id)).replace(&quot;b&quot;,&quot;&quot;).replace(&quot;\&#x27;&quot;,&quot;&quot;)<br> <br> <br>for p in cap:<br>    try:<br>        if len(p.modbus.word_cnt) == 5:<br>            tmp = p.modbus.word_cnt<br>            tmp = str(hex(int(p.modbus.word_cnt))).replace(&quot;0x&quot;,&quot;&quot;)<br>            flag = flag + tmp<br>    except:<br>        pass<br> <br>flag = hex2str(flag)<br>print(flag)<br> <br>#MMYWMX3GNEYWOXZRGAYDA=<br></code></pre></td></tr></table></figure>







<h5 id="3、-闽盾杯-2021-DNS协议分析"><a href="#3、-闽盾杯-2021-DNS协议分析" class="headerlink" title="3、[闽盾杯 2021]DNS协议分析"></a>3、[闽盾杯 2021]DNS协议分析</h5><p> 可以看到base64的多级域名</p>
<p>tshark.exe -r .\dns.pcapng -T fields -e dns.qry.name -Y “dns” &gt; dns.txt</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/18.png" srcset="/img/loading.gif" lazyload></font></p>
<p>提取出来</p>
<p>手工拼接一下即可</p>
<h5 id="4、-安洵杯-2019-Attack"><a href="#4、-安洵杯-2019-Attack" class="headerlink" title="4、[安洵杯 2019]Attack"></a>4、[安洵杯 2019]Attack</h5><p> Attack.pcap放进kali里foremost一下，得到一个加密的flag.txt，提示  </p>
<p><code>这可是administrator的秘密，怎么能随便给人看呢？</code></p>
<p>发现了<code>lsass.dmp</code></p>
<details class="lake-collapse"><summary id="u3285300b"><span class="ne-text"> lsass.dmp介绍如下：</span></summary><p id="u0c959860" class="ne-p"><strong><span class="ne-text">文件概述</span></strong></p><p id="u529cda16" class="ne-p" style="margin-left: 2em"><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><span class="ne-text">是“Local Security Authority Subsystem Service”（LSASS）进程的内存转储文件。LSASS是Windows操作系统中一个至关重要的组件，它在系统安全方面发挥着核心作用。</span></p><p id="u5cbcfc99" class="ne-p" style="margin-left: 2em"><span class="ne-text">从本质上讲，这个文件是通过对LSASS进程内存中的数据进行提取并保存而形成的，包含了当时进程内存中的各种信息。</span></p><p id="u74d9ae9c" class="ne-p"><strong><span class="ne-text">LSASS进程的重要性</span></strong></p><p id="u43a8eb03" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">用户认证方面</span></strong><span class="ne-text">：LSASS负责处理用户登录和身份验证。当用户在Windows系统中输入用户名和密码登录时，这些信息会被LSASS进行验证。它会根据本地安全数据库（如SAM - Security Account Manager数据库）或者联系域控制器（在域环境下）来检查用户提供的凭据是否正确。</span></p><p id="u0dd24732" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">安全策略实施</span></strong><span class="ne-text">：它执行本地安全策略，比如密码策略（包括密码长度、复杂性要求等）、账户锁定策略等。这些策略决定了用户账户的安全性和访问权限。</span></p><p id="ud06bf952" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">票据管理</span></strong><span class="ne-text">：在Windows的身份验证和授权体系中，LSASS还涉及到生成和管理Kerberos票据等操作。Kerberos票据是一种用于在网络环境中验证用户身份和授权访问资源的重要凭证。</span></p><p id="u33c78d47" class="ne-p"><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><strong><span class="ne-text">文件内容的重要性和潜在风险</span></strong></p><p id="uc9653c38" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">包含密码相关信息</span></strong><span class="ne-text">：</span><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><span class="ne-text">文件可能包含用户登录密码的哈希值。哈希值是一种单向加密后的结果，虽然不能直接还原出密码，但通过一些密码破解工具和技术（如彩虹表攻击、暴力破解等），可以尝试找到对应的原始密码。这使得该文件成为攻击者觊觎的目标，因为获取密码哈希就有可能获取用户账户的访问权限。</span></p><p id="u506e6568" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">包含用户和系统安全信息</span></strong><span class="ne-text">：文件中还可能有用户账户信息、安全标识符（SIDs）、授权数据等。这些信息对于了解系统的安全状态、用户权限分配以及可能存在的安全漏洞都非常重要。</span></p><p id="u9c549f6c" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">安全风险提示</span></strong><span class="ne-text">：正因为</span><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><span class="ne-text">文件包含如此敏感的信息，在未经授权的情况下获取和使用这个文件是非法的，并且会对系统安全和用户隐私造成严重威胁。只有在合法的安全测试（如企业内部的渗透测试，且经过严格的授权和控制流程）环境下，才能对这个文件进行分析。</span></p><p id="u040c6fea" class="ne-p"><strong><span class="ne-text">生成方式和用途</span></strong></p><p id="ueb6395bf" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">生成方式</span></strong><span class="ne-text">：通常可以使用专业的工具来生成</span><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><span class="ne-text">文件。例如，在安全测试场景中，像Mimikatz这样的工具可以通过特权提升后对LSASS进程进行内存转储操作。但这种操作需要在合适的权限下进行，并且在合法的环境中。</span></p><p id="ua9102e41" class="ne-p" style="margin-left: 2em"><strong><span class="ne-text">合法用途</span></strong><span class="ne-text">：在合法授权的安全研究场景下，安全分析师可以通过分析</span><code class="ne-code"><span class="ne-text">lsass.dmp</span></code><span class="ne-text">文件来检测系统是否存在安全漏洞，例如检查密码哈希是否被恶意篡改、是否存在异常的用户登录票据等情况。这有助于评估系统的安全性，提前发现潜在的安全风险，并采取相应的防护措施。</span></p></details>
导出该文件

<p>在Attack.pcap中文件-&gt;导出对象-&gt;http  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/19.png" srcset="/img/loading.gif" lazyload></font></p>
<p>接下来使用工具： mimikatz  </p>
<blockquote>
<p>&#x2F;&#x2F;提升权限</p>
<p>privilege::debug</p>
<p>&#x2F;&#x2F;载入dmp文件</p>
<p>&#x2F;&#x2F;lsass.dmp文件放在mimikatz同级目录下或者指定绝对路径用””框起来</p>
<p>sekurlsa::minidump lsass.dmp    </p>
<p>&#x2F;&#x2F;读取登陆密码</p>
<p>sekurlsa::logonpasswords full</p>
<p>得到密码</p>
<p>W3lc0meToD0g3</p>
</blockquote>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/20.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 用密码打开txt即可，得到flag  </p>
<h5 id="5、usb流量"><a href="#5、usb流量" class="headerlink" title="5、usb流量"></a>5、usb流量</h5><p>简介：</p>
<p>USB流量指的是USB设备接口的流量，攻击者能够通过监听usb接口流量获取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。在CTF中，USB流量分析主要以键盘和鼠标流量为主</p>
<p><a target="_blank" rel="noopener" href="https://jothon.github.io/2024/07/22/usb%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#usb%E6%B5%81%E9%87%8F">usb流量分析</a></p>
<p>主要就是看<code>usbhid.data</code>的值</p>
<p>设置过滤表达式为<code>usbhid.data</code>,观察值</p>
<p>键盘流量数据长度为<strong>8字节</strong></p>
<hr>
<p>** 鼠标流量数据长度是4字节**</p>
<hr>
<p> wireshark里分析可以为usb中的键盘流量  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/21.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 搜索8个长度的字节包 ,可以发现其有2.8.1和2.10.1  </p>
<p>命令：<code>usb.data_len == 8</code></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/22.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 使用tshark将其分别导出该usb版本数据  </p>
<p>tshark -r usb.pcapng -T fields -e usbhid.data -Y “usb.data_len &#x3D;&#x3D; 8” &gt; 3.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs plain">import re<br><br>normalKeys = &#123;&quot;04&quot;: &quot;a&quot;, &quot;05&quot;: &quot;b&quot;, &quot;06&quot;: &quot;c&quot;, &quot;07&quot;: &quot;d&quot;, &quot;08&quot;: &quot;e&quot;, &quot;09&quot;: &quot;f&quot;, &quot;0a&quot;: &quot;g&quot;, &quot;0b&quot;: &quot;h&quot;, &quot;0c&quot;: &quot;i&quot;,<br>              &quot;0d&quot;: &quot;j&quot;, &quot;0e&quot;: &quot;k&quot;, &quot;0f&quot;: &quot;l&quot;, &quot;10&quot;: &quot;m&quot;, &quot;11&quot;: &quot;n&quot;, &quot;12&quot;: &quot;o&quot;, &quot;13&quot;: &quot;p&quot;, &quot;14&quot;: &quot;q&quot;, &quot;15&quot;: &quot;r&quot;,<br>              &quot;16&quot;: &quot;s&quot;, &quot;17&quot;: &quot;t&quot;, &quot;18&quot;: &quot;u&quot;, &quot;19&quot;: &quot;v&quot;, &quot;1a&quot;: &quot;w&quot;, &quot;1b&quot;: &quot;x&quot;, &quot;1c&quot;: &quot;y&quot;, &quot;1d&quot;: &quot;z&quot;, &quot;1e&quot;: &quot;1&quot;,<br>              &quot;1f&quot;: &quot;2&quot;, &quot;20&quot;: &quot;3&quot;, &quot;21&quot;: &quot;4&quot;, &quot;22&quot;: &quot;5&quot;, &quot;23&quot;: &quot;6&quot;, &quot;24&quot;: &quot;7&quot;, &quot;25&quot;: &quot;8&quot;, &quot;26&quot;: &quot;9&quot;, &quot;27&quot;: &quot;0&quot;,<br>              &quot;28&quot;: &quot;&lt;RET&gt;&quot;, &quot;29&quot;: &quot;&lt;ESC&gt;&quot;, &quot;2a&quot;: &quot;&lt;DEL&gt;&quot;, &quot;2b&quot;: &quot;\t&quot;, &quot;2c&quot;: &quot;&lt;SPACE&gt;&quot;, &quot;2d&quot;: &quot;-&quot;, &quot;2e&quot;: &quot;=&quot;, &quot;2f&quot;: &quot;[&quot;,<br>              &quot;30&quot;: &quot;]&quot;, &quot;31&quot;: &quot;\\&quot;, &quot;32&quot;: &quot;&lt;NON&gt;&quot;, &quot;33&quot;: &quot;;&quot;, &quot;34&quot;: &quot;&#x27;&quot;, &quot;35&quot;: &quot;&lt;GA&gt;&quot;, &quot;36&quot;: &quot;,&quot;, &quot;37&quot;: &quot;.&quot;, &quot;38&quot;: &quot;/&quot;,<br>              &quot;39&quot;: &quot;&lt;CAP&gt;&quot;, &quot;3a&quot;: &quot;&lt;F1&gt;&quot;, &quot;3b&quot;: &quot;&lt;F2&gt;&quot;, &quot;3c&quot;: &quot;&lt;F3&gt;&quot;, &quot;3d&quot;: &quot;&lt;F4&gt;&quot;, &quot;3e&quot;: &quot;&lt;F5&gt;&quot;, &quot;3f&quot;: &quot;&lt;F6&gt;&quot;,<br>              &quot;40&quot;: &quot;&lt;F7&gt;&quot;, &quot;41&quot;: &quot;&lt;F8&gt;&quot;, &quot;42&quot;: &quot;&lt;F9&gt;&quot;, &quot;43&quot;: &quot;&lt;F10&gt;&quot;, &quot;44&quot;: &quot;&lt;F11&gt;&quot;, &quot;45&quot;: &quot;&lt;F12&gt;&quot;&#125;<br>shiftKeys = &#123;&quot;04&quot;: &quot;A&quot;, &quot;05&quot;: &quot;B&quot;, &quot;06&quot;: &quot;C&quot;, &quot;07&quot;: &quot;D&quot;, &quot;08&quot;: &quot;E&quot;, &quot;09&quot;: &quot;F&quot;, &quot;0a&quot;: &quot;G&quot;, &quot;0b&quot;: &quot;H&quot;, &quot;0c&quot;: &quot;I&quot;,<br>             &quot;0d&quot;: &quot;J&quot;, &quot;0e&quot;: &quot;K&quot;, &quot;0f&quot;: &quot;L&quot;, &quot;10&quot;: &quot;M&quot;, &quot;11&quot;: &quot;N&quot;, &quot;12&quot;: &quot;O&quot;, &quot;13&quot;: &quot;P&quot;, &quot;14&quot;: &quot;Q&quot;, &quot;15&quot;: &quot;R&quot;,<br>             &quot;16&quot;: &quot;S&quot;, &quot;17&quot;: &quot;T&quot;, &quot;18&quot;: &quot;U&quot;, &quot;19&quot;: &quot;V&quot;, &quot;1a&quot;: &quot;W&quot;, &quot;1b&quot;: &quot;X&quot;, &quot;1c&quot;: &quot;Y&quot;, &quot;1d&quot;: &quot;Z&quot;, &quot;1e&quot;: &quot;!&quot;,<br>             &quot;1f&quot;: &quot;@&quot;, &quot;20&quot;: &quot;#&quot;, &quot;21&quot;: &quot;$&quot;, &quot;22&quot;: &quot;%&quot;, &quot;23&quot;: &quot;^&quot;, &quot;24&quot;: &quot;&amp;&quot;, &quot;25&quot;: &quot;*&quot;, &quot;26&quot;: &quot;(&quot;, &quot;27&quot;: &quot;)&quot;,<br>             &quot;28&quot;: &quot;&lt;RET&gt;&quot;, &quot;29&quot;: &quot;&lt;ESC&gt;&quot;, &quot;2a&quot;: &quot;&lt;DEL&gt;&quot;, &quot;2b&quot;: &quot;\t&quot;, &quot;2c&quot;: &quot;&lt;SPACE&gt;&quot;, &quot;2d&quot;: &quot;_&quot;, &quot;2e&quot;: &quot;+&quot;, &quot;2f&quot;: &quot;&#123;&quot;,<br>             &quot;30&quot;: &quot;&#125;&quot;, &quot;31&quot;: &quot;|&quot;, &quot;32&quot;: &quot;&lt;NON&gt;&quot;, &quot;33&quot;: &quot;\&quot;&quot;, &quot;34&quot;: &quot;:&quot;, &quot;35&quot;: &quot;&lt;GA&gt;&quot;, &quot;36&quot;: &quot;&lt;&quot;, &quot;37&quot;: &quot;&gt;&quot;, &quot;38&quot;: &quot;?&quot;,<br>             &quot;39&quot;: &quot;&lt;CAP&gt;&quot;, &quot;3a&quot;: &quot;&lt;F1&gt;&quot;, &quot;3b&quot;: &quot;&lt;F2&gt;&quot;, &quot;3c&quot;: &quot;&lt;F3&gt;&quot;, &quot;3d&quot;: &quot;&lt;F4&gt;&quot;, &quot;3e&quot;: &quot;&lt;F5&gt;&quot;, &quot;3f&quot;: &quot;&lt;F6&gt;&quot;,<br>             &quot;40&quot;: &quot;&lt;F7&gt;&quot;, &quot;41&quot;: &quot;&lt;F8&gt;&quot;, &quot;42&quot;: &quot;&lt;F9&gt;&quot;, &quot;43&quot;: &quot;&lt;F10&gt;&quot;, &quot;44&quot;: &quot;&lt;F11&gt;&quot;, &quot;45&quot;: &quot;&lt;F12&gt;&quot;&#125;<br>output = []<br><br>txt = open(&#x27;usbdata.txt&#x27;, &#x27;r&#x27;)<br><br>for line in txt:<br>    line = line.strip(&#x27;\n&#x27;)<br>    if len(line) == 16:<br>        line_list = re.findall(&#x27;.&#123;2&#125;&#x27;, line)<br>        line = &quot;:&quot;.join(line_list)<br>        try:<br>            if line[0] != &#x27;0&#x27; or (line[1] != &#x27;0&#x27; and line[1] != &#x27;2&#x27;) or line[3] != &#x27;0&#x27; or line[4] != &#x27;0&#x27; or line[<br>                9] != &#x27;0&#x27; or line[10] != &#x27;0&#x27; or line[12] != &#x27;0&#x27; or line[13] != &#x27;0&#x27; or line[15] != &#x27;0&#x27; or line[<br>                16] != &#x27;0&#x27; or line[18] != &#x27;0&#x27; or line[19] != &#x27;0&#x27; or line[21] != &#x27;0&#x27; or line[22] != &#x27;0&#x27; or line[<br>                                                                                                          6:8] == &quot;00&quot;:<br>                continue<br>            if line[6:8] in normalKeys.keys():<br>                output += [[normalKeys[line[6:8]]], [shiftKeys[line[6:8]]]][line[1] == &#x27;2&#x27;]<br>            else:<br>                output += [&#x27;[unknown]&#x27;]<br>        except:<br>            pass<br><br>txt.close()<br><br>flag = 0<br>print(&quot;&quot;.join(output))<br>for i in range(len(output)):<br>    try:<br>        a = output.index(&#x27;&lt;DEL&gt;&#x27;)<br>        del output[a]<br>        del output[a - 1]<br>    except:<br>        pass<br>for i in range(len(output)):<br>    try:<br>        if output[i] == &quot;&lt;CAP&gt;&quot;:<br>            flag += 1<br>            output.pop(i)<br>            if flag == 2:<br>                flag = 0<br>        if flag != 0:<br>            output[i] = output[i].upper()<br>    except:<br>        pass<br>print(&#x27;output :&#x27; + &quot;&quot;.join(output))<br># moectf&#123;&lt;CAP&gt;l&lt;CAP&gt;earnee&lt;DEL&gt;d_a6ou7_&lt;CAP&gt;usb&lt;CAP&gt;_tr@ffic&#125;<br># output :moectf&#123;Learned_a6ou7_USB_tr@ffic&#125;<br></code></pre></td></tr></table></figure>

<p> grep分离：<code>strings -a cap.pcapng |grep &quot;\[.*\]&quot;</code></p>
<h5 id="6、陇剑杯-2021-wifi"><a href="#6、陇剑杯-2021-wifi" class="headerlink" title="[6、陇剑杯 2021]wifi"></a><font style="color:#fff;">[</font><font style="color:#000000;">6、陇剑杯 2021]wifi</font></h5><blockquote>
<p><strong>网管小王最近喜欢上了ctf网络安全竞赛，他使用“哥斯拉”木马来玩玩upload-labs，并且保存了内存镜像、wifi流量和服务器流量，让您来分析后作答：</strong></p>
<p><strong>小王往upload-labs上传木马后进行了cat &#x2F;flag，flag内容为_____________。（压缩包里有解压密码的提示，需要额外添加花括号）</strong></p>
</blockquote>
<p> 给了一个服务器流量包，一个客户端流量包，一个内存镜像  </p>
<p>先看服务器流量</p>
<p>追踪http流发现是 哥斯拉php_eval_xor_base64流量</p>
<p>哥斯拉流量特征：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/smileleooo/p/18178347">https://www.cnblogs.com/smileleooo/p/18178347</a></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/23.png" srcset="/img/loading.gif" lazyload></font></p>
<p>我们把pass里面的内容进行解密</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/24.png" srcset="/img/loading.gif" lazyload></font></p>
<p>得到了key</p>
<p> 再看客户端.cap  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/25.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 发现是wifi的流量，可以看到wifi名叫My_Wifi</p>
<p>再去看内存镜像，这时思路就很明确了。需要找到在内存镜像中保存的wifi密码.</p>
<p>在windows中保存的wifi密码通常在.xml文件中，使用工具：Lovelymemv</p>
<p>使用功能：文件扫描(filescan)</p>
<p>没有找到，再搜索wifi名：My_Wifi  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/26.png" srcset="/img/loading.gif" lazyload></font></p>
<p>右键单击导出该压缩包</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/27.png" srcset="/img/loading.gif" lazyload></font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/28.png" srcset="/img/loading.gif" lazyload></font></p>
<p>需要密码打开（前面题目已经给了提示）</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/29.png" srcset="/img/loading.gif" lazyload></font></p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/30.png" srcset="/img/loading.gif" lazyload></font></p>
<p>搜索关键字：Interfaces  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/31.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 用GUID解压My_Wifi.zip获取wifi密码233@114514_qwe  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/32.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 使用这个密码来解密WiFi流量客户端.cap  </p>
<details class="lake-collapse"><summary id="uf48928ea"><span class="ne-text">wpa - pwd介绍</span></summary><ul class="ne-ul"><li id="u863b6c12" data-lake-index-type="0"><strong><span class="ne-text">概念解释</span></strong></li><li id="u2e37e1c4" data-lake-index-type="0"><span class="ne-text">“wpa - pwd” 通常是指在设置 Wi - Fi 无线网络加密时的一种密码（口令）格式，用于 WPA（Wi - Fi Protected Access）或 WPA2 加密方式下的预共享密钥（PSK）输入。</span></li><li id="u3bd69ebd" data-lake-index-type="0"><span class="ne-text">当你在配置无线路由器或者查看 Wi - Fi 连接信息时，可能会看到以 “wpa - pwd” 为前缀的密码格式相关内容。它本质上是一种方便用户设置和表示 Wi - Fi 密码的方式。</span></li><li id="udb13b8a3" data-lake-index-type="0"><strong><span class="ne-text">格式与示例</span></strong></li><li id="ue8a8dd7f" data-lake-index-type="0"><span class="ne-text">其格式一般为 “wpa - pwd: 加密后的密码：SSID（无线网络名称）”。例如，“wpa - pwd:1a2b3c4d5e6f7g8h:MyWiFi”，这里 “1a2b3c4d5e6f7g8h” 是经过某种加密算法处理后的 Wi - Fi 密码（实际应用中用户设置的是原始密码，系统会进行加密处理后以这种格式存储或显示部分信息），“MyWiFi” 是无线网络的名称（SSID）。</span></li></ul></details>

<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/33.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 选择protocols<br>找到IEEE 802.11  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/34.png" srcset="/img/loading.gif" lazyload></font></p>
<p>选择：wpa-pwd      填入：233@114514_qwe:My_Wifi</p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/35.png" srcset="/img/loading.gif" lazyload></font></p>
<p>也可以用无线攻击Airdecap-ng  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/36.png" srcset="/img/loading.gif" lazyload></font></p>
<p> 然后再解密后的客户端流量包里找密文，在最后一个tcp流的末尾找到了正确的密文  </p>
<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/37.png" srcset="/img/loading.gif" lazyload></font></p>
<p>找一个哥斯拉解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">&lt;?php <br>//直接使用encode方法<br>function encode($D,$K)&#123;<br>    for($i=0;$i&lt;strlen($D);$i++) &#123;<br>        $c = $K[$i+1&amp;15];<br>        $D[$i] = $D[$i]^$c;<br>    &#125;<br>    return $D;<br>&#125;<br> <br>$key=&#x27;3c6e0b8a9c15224a&#x27;;//这里的KEY是从前面提取到的<br>$key1=&quot;密文&quot;;<br>$str=substr($key1,16,-16);//原来的数据去掉前十六位和后十六位<br>$str=gzdecode(encode(base64_decode($str),$key));<br>echo $str;<br> ?&gt;<br></code></pre></td></tr></table></figure>



<p><font style="background-color:#FAFAFA;"><img src="/img/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/38.png" srcset="/img/loading.gif" lazyload></font></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%8F%96%E8%AF%81/" class="category-chain-item">取证</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="print-no-link">#应急响应</a>
      
        <a href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" class="print-no-link">#流量分析</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>流量分析</div>
      <div>http://example.com/2025/01/09/流量分析/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Th1n_Ker</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年1月9日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/12/13/windows%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/" title="windwos入侵排查">
                        <span class="hidden-mobile">windwos入侵排查</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
